# Module 12: Server-side Template Injection - Discovery and Exploitation

## Templating Engines

### Accessing the Template Sandbox

_Start the VPN, VM, and add IP to hosts._

### Introduction to Templating Engines

_Example Email_

```
Hello Dragan,

Thank you for your order! Your items will be shipped out shortly:

Widget - $10
	Quantity: 3
	Total: 	$30
Toolkit - $20
	Quantity: 1
	Total: 	$20
_______________
Total: 		$50

These items will be shipped to:

194 Bridge Avenue Elton, Louisiana 70532
```

_Example Template Email_

```
01  Hello {{ name }},
02
03  Thank you for your order! Your items will be shipped out shortly:
04  {% raw %}
{% for product in cart %}
05  {{product.name}}
06          Price:  ${{product.price}}
07          Quantity: {{product.quantity}}
08          Total:  ${{product.quantity * product.price}}
09  {% endfor %}____________________
10  Total:          ${{total}}
11
12  {% if cart|length > 1 %}
13  These items{% else %}
14  This item{% endif %}
{% endraw %} will be shipped to:
15  {{address}}
```

_Example Template Variables_

```json
{
	"name": "Dragan",
	"address": "194 Bridge Avenue Elton, Louisiana 70532",
	"cart": [
		{
			"name": "Widget",
			"quantity": 3,
			"price": 10
		},
		{
			"name": "Toolkit",
			"quantity": 1,
			"price": 20
		}
	],
	"total": 50
}
```

_Greeting the user_

```
01  Hello {{ name }},
...
```

_Template For Loop_

```
04  {% raw %}
{% for product in cart %}
05  {{product.name}}
06          Price:  ${{product.price}}
07          Quantity: {{product.quantity}}
08          Total:  ${{product.quantity * product.price}}
09  {% endfor %}
{% endraw %}
```

_Displaying the total_

```
10  Total:          ${{total}}
```

_Template If Statement_

```
12  {% raw %}
{% if cart|length > 1 %}
13  These items{% else %}
14  This item{% endif %}
{% endraw %} will be shipped to:
15  {{address}}
```

_Various Templating Engines_

| Templating Engine | Language       | Server/client Side |
| ----------------- | -------------- | ------------------ |
| Twig              | PHP            | Server Side        |
| Freemarker        | Java (usually) | Server Side        |
| Pug/Jade          | JavaScript     | Mostly Server Side |
| Jinja             | Python         | Server Side        |
| Handlebars        | JavaScript     | Both               |
| Mustache          | Multiple       | Varies             |

<figure><img src="../../../.gitbook/assets/6feaa546c557d9ebe7beb2470a461359-ssti_logic_compare.png" alt=""><figcaption><p>Comparing levels of logic</p></figcaption></figure>





## Twig - Discovery and Exploitation

### Twig - Discovery



### Twig - Exploitation



## Apache Freemarker - Discovery and Exploitation

### Freemarker - Discovery



### Freemarker - Exploitation



## Pug - Discovery and Exploitation

### Pug - Discovery



### Pug - Exploitation



## Jinja - Discovery and Exploitation

### Jinja - Discovery



### Jinja - Exploitation



## Mustache and Handlebars - Discovery and Exploitation

### Mustache and Handlebars - Discovery



### Mustache and Handlebars - Exploitation



## Halo - Case Study

### Accessing Halo



### Halo - Translation and Discovery



### Halo - Exploitation



### Extra Mile



## Craft CMS with Sprout Forms - Case Study

### Accessing Craft CMS



### Craft CMS with Sprout Forms - Discovery



### Craft CMS with Sprout Forms - Exploitation

