# Module 9: Incident Response Case Management

## Creating and Managing Incident Cases

### Following Along

_Just a section for starting the VM group._

### Introducing IRIS for Case Management

<figure><img src="../../../.gitbook/assets/0ab76f4e964ac826dd9defdaae3e717e-iris_init.png" alt=""><figcaption><p>The IRIS login page</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/ddc4c653174ed359fd34c52e8efac3db-iris_first.png" alt=""><figcaption><p>The IRIS dashboard</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/68c571d53c8e98579511b354d7a8a989-iris_customer_navigate.png" alt=""><figcaption><p>Navigating to the customer management page</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/2dd450cbe4f076482dd2a2fe181c46ce-iris_customer_manage.png" alt=""><figcaption><p>The Customer management page</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/27d88910f2331755aa7aef491e9ff8e7-iris_customer.png" alt=""><figcaption><p>Entering our customer's information</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/8211458a0951d97f1213c5afd5f09598-iris_customer_added.png" alt=""><figcaption><p>Our new customer</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/34d45d06c709cb23807e554c98a771af-add_case_dashboard.png" alt=""><figcaption><p>The IRIS dashboard and Add Case button</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/b01e549bb201aeee6ce0ad088d605b4a-add_case_all_fields.png" alt=""><figcaption><p>The fields for adding a new case in IRIS</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/eb95228f1b4ee32be02b5290202ed6a6-add_case_customer.png" alt=""><figcaption><p>The Select customer dropdown</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/835f7fa46f2935f5bfa99d07d449ffc7-add_case_classification.png" alt=""><figcaption><p>Some of the options under Select classification</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/72d04cf2bac94ad6c5588350a13e8870-add_case_filled_out.png" alt=""><figcaption><p>All of the fields in our new case</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/2dfe9a23e48da21ca35bb8a11ef00665-add_case_success.png" alt=""><figcaption><p>Successful case creation message</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/38976f4d62b671fad0ee89d836fee09e-add_case_open_cases.png" alt=""><figcaption><p>Our new case in list of open cases</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/f64d419d1e2640b65b207648d4be141e-add_case_case_page.png" alt=""><figcaption><p>The page for our case</p></figcaption></figure>

### Adding Assets

<figure><img src="../../../.gitbook/assets/2851e0fac4ef1a501705c7d2c2bdb43b-add_asset_tab.png" alt=""><figcaption><p>The Assets tab</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/9b6f1e210310a69fce80ce7599acb1c5-add_asset_all_fields.png" alt=""><figcaption><p>The fields to add an asset</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/85d2e7f6f6465008aba70cf44d5a0056-add_asset_types.png" alt=""><figcaption><p>Available asset types</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/5d19d79e931ab6157455643cfb4b21f3-add_asset_compromise_status.png" alt=""><figcaption><p>Available compromise statuses</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/c6c2d257603d19db338aaa61ea6c26bc-add_asset_analysis_status.png" alt=""><figcaption><p>Available analysis statuses</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/3f0689e1e0add5d412edac47994ddfa5-add_asset_filled_out.png" alt=""><figcaption><p>All the fields for our new asset</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/fb9fe9c1c807cc576726c3660ae2b231-add_asset_list_client01.png" alt=""><figcaption><p>Our new asset in the list of assets</p></figcaption></figure>

### Creating a Timeline

<figure><img src="../../../.gitbook/assets/5c058688813826e9e05a6555af3bde81-splunk_search_button.png" alt=""><figcaption><p>Navigating to the search feature in Splunk</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/93eb957f4009eb1ae382fa00709b3eea-add_event_splunk_query.png" alt=""><figcaption><p>Querying for our event in Splunk</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/a019a5e5556e7e6401fcb139605e2e92-add_event_list_empty.png" alt=""><figcaption><p>The Timeline tab in IRIS</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/6a11ceecd18b79a3ce694e7d7dddd4c2-add_event_all_fields.png" alt=""><figcaption><p>The fields to add an event in IRIS</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/2bc8c6ec411608453ec2f1dc0c2d5b3b-add_event_time.png" alt=""><figcaption><p>Specifying our event's time</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/083e502dc3f34b20a86a9a78595d5c37-add_event_splunk_expand_1.png" alt=""><figcaption><p>Expanding our Splunk log</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/1d7e52232cdbd0660036cfc30d2cb6a6-add_event_splunk_expand_2.png" alt=""><figcaption><p>Opening the raw log</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/45852ca7fbc0fa276176bb67d806276e-add_event_splunk_raw_log.png" alt=""><figcaption><p>Locating our raw log</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/90f05442a8d2b890b1ebb1a73f5d4d27-add_event_raw_log.png" alt=""><figcaption><p>Pasting our raw log into IRIS</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/3260b8cc90fc300db0c272996ee60f20-add_event_link_asset.png" alt=""><figcaption><p>Linking our event to an asset</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/1452c2eb9cad9ed1f36e26a1762b4c95-add_event_category.png" alt=""><figcaption><p>The event category options in IRIS</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/c1e0077623a9e4870c10334a51224750-add_event_filled_out.png" alt=""><figcaption><p>All of our fields to add our event</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/c9cc30639ff7a59ff1b12ca205106d01-add_event_list_new.png" alt=""><figcaption><p>Our new event in the timeline</p></figcaption></figure>

### Adding Evidence

_Email evidence in lab scenario:_

{% code overflow="wrap" %}
```splunk-spl
Return-Path: d.miller@gmail.com
Received: from kali (Unknown [172.16.50.254])
	by mail01.tech.com with ESMTP
	; Wed, 18 Oct 2023 08:04:04 -0700
Date: Wed, 18 Oct 2023 11:04:03 -0400
To: a.jones@tech.com
From: d.miller@gmail.com
Subject: Application as UI UX Designer
Message-Id: <20231018110403.1751702@kali>
X-Mailer: swaks v20201014.0 jetmore.org/john/code/swaks/
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="----=_MIME_BOUNDARY_000_1751702"

------=_MIME_BOUNDARY_000_1751702
Content-Type: text/plain

Hey!
I attached my application for the UI/UX design position. It is stored in the .iso file and built when you execute the binary.

David

------=_MIME_BOUNDARY_000_1751702
Content-Type: application/octet-stream; name="application.iso"
Content-Description: application.iso
Content-Disposition: attachment; filename="application.iso"
Content-Transfer-Encoding: BASE64

AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
...(CUT)...
```
{% endcode %}

<figure><img src="../../../.gitbook/assets/cc70912e2ff78fe2ce37df80a87d91c2-evidence_00_datastore.png" alt=""><figcaption><p>The datastore icon</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/f5670722e31c97364883d39e8704eaa3-evidence_01_datastore.png" alt=""><figcaption><p>The Summary tab</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/fa013da4af1d8a70dddba0f5673a0ffb-evidence_02_folders.png" alt=""><figcaption><p>Adding a file</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/bf98e311a7d7b68a4574cb8a6ed25c2f-add_evidence_file.png" alt=""><figcaption><p>The fields to upload a file</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/4abc781f8ba64073686495672311fd4e-add_evidence_filled_out.png" alt=""><figcaption><p>All of the fields to upload evidence filled out</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/389b95dde515a40bd4a6321a7a24a11b-evidence_04_email_added.png" alt=""><figcaption><p>Our file in the datastore</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/5267371825630ceef98bcada3e0e4a7b-add_evidence_evidences.png" alt=""><figcaption><p>Our file under the Evidences tab</p></figcaption></figure>

### Communicating and Collaborating

<figure><img src="../../../.gitbook/assets/54f4e79f6ca6559d96c907bd80f6bf14-event_comment_add.png" alt=""><figcaption><p>Adding a comment to an event</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/ae25a35581ddfb56ac81f648be00fb8e-event_comments.png" alt=""><figcaption><p>A series of comments on the event</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/e1bb2170c4dd9aa73d0064453cb9b8be-add_task_tab.png" alt=""><figcaption><p>The tasks tab</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/afe6dc9eec68d190962f5aca90c73b64-add_task_filled_out.png" alt=""><figcaption><p>The fields to create a task</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/403ea0dd685c2752f7dbfd0c05408543-add_task_new.png" alt=""><figcaption><p>Our new task</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/fa6437cf5cecacc3ae715d2f99c7fbcc-access_adv_access.png" alt=""><figcaption><p>Navigating to Access control</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/1122277aa6ff2737a5757f917f3d5d3f-access_adv_users.png" alt=""><figcaption><p>Managing user access</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/c28b0e8c955536134f5bfa6465de6041-access_adv_admin.png" alt=""><figcaption><p>The access of the administrator user</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/0a05955f580781503c83262dc798aee1-access_adv_set_1.png" alt=""><figcaption><p>The case options</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/b5ab9ed85cdeb6853134001ff3e39e89-access_adv_set_2.png" alt=""><figcaption><p>Access type options</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/ce44c24d8e8a15bf99010a83a95eb461-access_adv_groups.png" alt=""><figcaption><p>Managing group access</p></figcaption></figure>

### Generating a Report

<figure><img src="../../../.gitbook/assets/2b53ebefa1b985ba41bd9ca71a66ed88-report_advanced_templates.png" alt=""><figcaption><p>Navigating to report templates</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/06bc31a9161da6be079d21c7fb485767-report_templates.png" alt=""><figcaption><p>Report templates list</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/28a8c2db12df2b945c20e316912ef52e-report_template_download.png" alt=""><figcaption><p>Downloading the report templates</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/b2a4a71236710784f603e38eb69dabe6-report_template_cover.png" alt=""><figcaption><p>The cover page of the report templates</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/dcd3fd770d13dcdc30680c3705123600-report_template_assets.png" alt=""><figcaption><p>The asset list in the report templates</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/ad6ed6ab0cd5d22a600ce9ff4c911367-report_generate.png" alt=""><figcaption><p>Our case's Summary tab</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/972982146323805a121b73a73136344d-report_generate_download.png" alt=""><figcaption><p>Generating and downloading our report template</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/d450d76811f8f75120203232a19c89da-report_template_cover_generated.png" alt=""><figcaption><p>The cover page of our report</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/320ebc2559b4cef8bdaf6b36328b0fea-report_template_assets_generated.png" alt=""><figcaption><p>The asset list in our report</p></figcaption></figure>

### Closing a Case and Case Retention

<figure><img src="../../../.gitbook/assets/61d4669b62ff44757673b67ba465b66d-close_manage.png" alt=""><figcaption><p>The Manage button</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/24fe683bd757d85bd3bdcea71e16a98b-close_edit.png" alt=""><figcaption><p>Editing the case</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/685bd95917b81d16a124d202fbc354b5-close_status.png" alt=""><figcaption><p>Editing the Outcome of the case</p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/aeecb9f1a42dc1ba4a3fa25ccb836bf1-close_close.png" alt=""><figcaption><p>Closing the case </p></figcaption></figure>

<figure><img src="../../../.gitbook/assets/cb1a340e0505b7f5314219c99cbeca83-close_closed.png" alt=""><figcaption><p>Our closed case</p></figcaption></figure>

_Becoming the root user on the IRIS server_

```bash
offsec@iris01:~$ sudo su
[sudo] password for offsec:

root@iris01:/home/offsec# cd /root/iris-web/
```

_IRIS case database backup step_

{% code overflow="wrap" %}
```bash
root@iris01:~/iris-web# docker container ls | grep iriswebapp_db
cd41ed129c5f   iriswebapp_db:v2.3.3           "docker-entrypoint.s..."   6 weeks ago   Up 5 weeks             127.0.0.1:5432->5432/tcp

root@iris01:~/iris-web# docker exec cd41ed129c5f pg_dump -U postgres iris_db | gzip > ../iris_db_backup.gz
```
{% endcode %}

## Creating a Case Based on Our Lab Incident

### Creating a Case For Our Incident

_Do it all again for the lab._

### Adding Our Compromised and Investigated Assets

_Do it all again for the lab._

### Creating a Timeline Based on What We Know

_Do it all again for the lab._

### Adding Evidence from Our Investigation

_Do it all again for the lab._
